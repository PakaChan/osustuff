
<html>
    <head>
    <title> ctb pp calculate</title> 
    <script>
        function print2(s)
        {
                document.getElementById("output2").innerHTML += s + "<br>"
        }
	function fu2()
	{
		document.getElementById("output2").innerHTML = "";
		if (combo.value=='') combo.value=mcombo.value;
		if (acc.value =='') acc.value=100;
		if (miss.value =='') miss.value=0;
		// Conversion from Star rating to pp
		final = Math.pow(((5*(stars.value)/ 0.0049)-4),2)/100000; 
		// Length Bonus
		lengthbonus = (0.95 + 0.4 * Math.min(1.0, mcombo.value / 3000.0) + (mcombo.value > 3000 ? Math.log10(mcombo.value / 3000.0) * 0.5 : 0.0));
		final *= lengthbonus;
		// Miss Penalty
		final *= Math.pow(0.97, miss.value);
		// Not FC combo penalty
		final *= Math.pow(combo.value/mcombo.value,0.8);
		// AR Bonus
		if (ar.value>9)
			final*= 1+  0.1 * (ar.value - 9.0);
		if (ar.value<8)
			final*= 1+  0.025 * (8.0 - ar.value);
		// Acc Penalty
		final *=  Math.pow(acc.value/100, 5.5);
		print2(" " + Math.round(final,3));
		print2("HD: " +  Math.round(final* (1.05 + 0.075 * (10.0 - Math.min(10, ar.value)))));
		print2("FL: " +  Math.round(final * 1.35 * lengthbonus));
		print2("HDFL: " +  Math.round(final* 1.35 * lengthbonus*(1.05 + 0.075 * (10.0 - Math.min(10, ar.value)))));
	}
    	function clear()
    	{
		document.getElementById("output2").innerHTML = "";
		miss.value ='';
		acc.value ='';
		combo.value ='';
		stars.value ='';
		ar.value ='';
		mcombo.value ='';
    	}
    </script> 
    </head>
    
<body>
	CTB pp calculator <br><br>
	Stars: <input type="text" id="stars"><br>
	AR: <input type=text id="ar"><br>
	Max Combo: <input type=text id="mcombo"><br>
	Combo: <input type=text id="combo"> (leave empty if fc)<br>
	Acc: <input type=text id="acc"> (leave empty if ss)<br>
	Miss Count: <input type=text id="miss"> (leave empty if 0)<br>
	<input type="button" id="button2" onclick="fu2()" value="Calculate" >
	<input type="button" id="buttonClear" onclick="clear()" value="Clear" ><br>
	<p id="output2">
	</p>
    </body>
</html>
